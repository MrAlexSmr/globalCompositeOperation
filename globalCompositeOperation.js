function globalCompositeOperation(r){"use strict";function t(r,t){return new Function("dest,src,destI,srcI,count",[r,"while(count-->0){",t.join(""),"destI+=4;","srcI+=4;","}"].join(""))}function e(r,e,s){return t(["var opt1,opt2,opt3,aSrcF,aDestF,aResF,rDest,rSrc,gDest,gSrc,bDest,bSrc;",r.join("")].join(""),["aSrcF=",v,"/255.0;","aDestF=",R,"/255.0;","opt1=aDestF*(1.0-aSrcF);","opt2=(1.0-aDestF)*aSrcF;","opt3=aSrcF*aDestF;","aResF=aSrcF+opt1;","rDest=",I,";","gDest=",g,";","bDest=",b,";","rSrc=",u,";","gSrc=",x,";","bSrc=",f,";",e.join(""),I,"=(opt2*rSrc+opt1*rDest+opt3*(",s("rDest","rSrc").join(""),"))/aResF;",g,"=(opt2*gSrc+opt1*gDest+opt3*(",s("gDest","gSrc").join(""),"))/aResF;",b,"=(opt2*bSrc+opt1*bDest+opt3*(",s("bDest","bSrc").join(""),"))/aResF;",R,"=aResF*255.0;"])}function s(r,t,e){return["(max(",r,",",t,",",e,")-min(",r,",",t,",",e,"))"].join("")}function a(r,t,e){return["(0.3*",r,"+0.59*",t,"+0.11*",e,")"].join("")}function F(r,t,e){return["D=L-",a(r,t,e),";","rRes=",r,"+D;","gRes=",t,"+D;","bRes=",e,"+D;"].join("")}function n(r,t,e){return["rgb[0]=",r,";","rgb[1]=",t,";","rgb[2]=",e,";","maxI=0;","if(rgb[1]>rgb[maxI])maxI=1;","if(rgb[2]>rgb[maxI])maxI=2;","minI=0;","if(rgb[1]<rgb[minI])minI=1;","if(rgb[2]<rgb[minI])minI=2;","if(maxI===minI){rgb[0]=rgb[1]=rgb[2]=0.0;}","else{","minEl=rgb[minI];","midI=3-(maxI+minI);","rgb[minI]=.0;","rgb[midI]=((rgb[midI]-minEl)*S)/(rgb[maxI]-minEl);","rgb[maxI]=S;","}",r,"=rgb[0];",t,"=rgb[1];",e,"=rgb[2];"].join("")}function o(){return["L=",a("rRes","gRes","bRes"),";","N=min(rRes,gRes,bRes);","X=max(rRes,gRes,bRes);","if(N<.0){","opt4=L-N;","if(opt4!==.0){","rRes=L+(((rRes-L)*L)/opt4);","gRes=L+(((gRes-L)*L)/opt4);","bRes=L+(((bRes-L)*L)/opt4);","}","}","if(X>1.0){","opt4=1.0-L;","opt5=X-L;","if(opt5!==.0){","rRes=L+(((rRes-L)*opt4)/opt5);","gRes=L+(((gRes-L)*opt4)/opt5);","bRes=L+(((bRes-L)*opt4)/opt5);","}","}","rRes=min(rRes*255.0,255.0);","gRes=min(gRes*255.0,255.0);","bRes=min(bRes*255.0,255.0);"].join("")}function c(){return["rDestF=rDest/255.0;","gDestF=gDest/255.0;","bDestF=bDest/255.0;","rSrcF=rSrc/255.0;","gSrcF=gSrc/255.0;","bSrcF=bSrc/255.0;"].join("")}var i,D,S,p,m={};r?(i="3",D="2",S="1",p="0"):(i="0",D="1",S="2",p="3");var I="dest[destI+"+i+"]",g="dest[destI+"+D+"]",b="dest[destI+"+S+"]",R="dest[destI+"+p+"]",u="src[srcI+"+i+"]",x="src[srcI+"+D+"]",f="src[srcI+"+S+"]",v="src[srcI+"+p+"]",l="var opt1,opt2,opt3,aSrcF,aDestF,aResF,rDest,rSrc,gDest,gSrc,bDest,bSrc;";return m.copy=t("",[I,"=",u,";",g,"=",x,";",b,"=",f,";",R,"=",v,";"]),m["source-over"]=t("var opt,aSrcF,aDestF,aResF,aDestI,aSrcI;",["aDestI=",R,";","aSrcI=",v,";","if(0x00===aDestI||0xFF===aSrcI){",I,"=",u,";",g,"=",x,";",b,"=",f,";",R,"=aSrcI;","}else{","aDestF=aDestI/255.0;","aSrcF=aSrcI/255.0;","opt=aDestF*(1.0-aSrcF);","aResF=aSrcF+opt;",I,"=(",u,"*aSrcF+",I,"*opt)/aResF;",g,"=(",x,"*aSrcF+",g,"*opt)/aResF;",b,"=(",f,"*aSrcF+",b,"*opt)/aResF;",R,"=aResF*255.0;","}"]),m["source-in"]=t("var aDestI;",["aDestI=",R,";","if(0x00===aDestI){",I,"=",g,"=",b,"=",R,"=0x00;","}else{",I,"=",u,";",g,"=",x,";",b,"=",f,";",R,"=((aDestI/255.0)*(",v,"/255.0))*255.0;","}"]),m["source-out"]=t("var aDestI;",["aDestI=",R,";","if(0xFF===aDestI){",I,"=",g,"=",b,"=",R,"=0x00;","}else{",I,"=",u,";",g,"=",x,";",b,"=",f,";",R,"=((",v,"/255.0)*(1.0-(aDestI/255.0)))*255.0;","}"]),m["source-atop"]=t("var opt,aSrcF,aDestI;",["aDestI=",R,";","if(0x00===aDestI){",I,"=",g,"=",b,"=",R,"=0x00;","}else{","aSrcF=",v,"/255.0;","opt=1.0-aSrcF;",I,"=",u,"*aSrcF+",I,"*opt;",g,"=",x,"*aSrcF+",g,"*opt;",b,"=",f,"*aSrcF+",b,"*opt;",R,"=aDestI;","}"]),m["destination-over"]=t("var opt,aSrcF,aDestF,aResF,aDestI,aSrcI;",["aDestI=",R,";","aSrcI=",v,";","if(0xFF!==aDestI&&0x00!==aSrcI){","aDestF=aDestI/255.0;","aSrcF=aSrcI/255.0;","opt=(1.0-aDestF)*aSrcF;","aResF=opt+aDestF;",I,"=(",u,"*opt+",I,"*aDestF)/aResF;",g,"=(",x,"*opt+",g,"*aDestF)/aResF;",b,"=(",f,"*opt+",b,"*aDestF)/aResF;",R,"=aResF*255.0;","}"]),m["destination-in"]=t("var aSrcI;",["aSrcI=",v,";","if(0x00===aSrcI){",I,"=",g,"=",b,"=",R,"=0x00;}","else{",R," *=aSrcI/255.0;}"]),m["destination-out"]=t("var aSrcI;",["aSrcI=",v,";","if(0xFF===aSrcI){",I,"=",g,"=",b,"=",R,"=0x00;}","else{",R,"=(",R,"/255.0)*(1.0-aSrcI/255.0)*255.0;}"]),m["destination-atop"]=t("var opt,aSrcF,aDestF,aSrcI;",["aSrcI=",v,";","if(0x00===aSrcI){",I,"=",g,"=",b,"=",R,"=0x00;","}else{","aSrcF=aSrcI/255.0;","aDestF=",R,"/255.0;","opt=1.0-aDestF;",I,"=",u,"*opt+",I,"*aDestF;",g,"=",x,"*opt+",g,"*aDestF;",b,"=",f,"*opt+",b,"*aDestF;",R,"=aSrcI;","}"]),m.xor=t("var opt1,opt2,aSrcF,aDestF,aResF;",["aSrcF=",v,"/255.0;","aDestF=",R,"/255.0;","aResF=aSrcF+aDestF-2.0*aSrcF*aDestF;","if(.0===aResF){",I,"=",g,"=",b,"=",R,"=0x00;","}else{","opt1=aSrcF*(1.0-aDestF);","opt2=aDestF*(1.0-aSrcF);",I,"=(",u,"*opt1+",I,"*opt2)/aResF;",g,"=(",x,"*opt1+",g,"*opt2)/aResF;",b,"=(",f,"*opt1+",b,"*opt2)/aResF;",R,"=aResF*255.0;","}"]),m.lighter=t(["var aSrcF,aDestF,aResF;","var min=Math.min;"].join(""),["aSrcF=",v,"/255.0;","aDestF=",R,"/255.0;","aResF=min(1.0,aSrcF+aDestF);","if(.0===aResF){",I,"=",g,"=",b,"=",R,"=0x00;","}else{",I,"=min((",u,"*aSrcF+",I,"*aDestF)/aResF,255.0);",g,"=min((",x,"*aSrcF+",g,"*aDestF)/aResF,255.0);",b,"=min((",f,"*aSrcF+",b,"*aDestF)/aResF,255.0);",R,"=aResF*255.0;","}"]),m.multiply=e([],[],function(r,t){return["(",r,"*",t,")/255.0"]}),m.screen=e([],[],function(r,t){return["255.0-((0xFF-",r,")*(0xFF-",t,"))/255.0"]}),m.overlay=e([],[],function(r,t){return[r,"<128","?(2*",t,"*",r,"/255.0)",":(0xFF-2*(0xFF-",t,")*(0xFF-",r,")/255.0)"]}),m.darken=e(["var min=Math.min;"],[],function(r,t){return["min(",r,",",t,")"]}),m.lighten=e(["var max=Math.max;"],[],function(r,t){return["max(",r,",",t,")"]}),m["color-dodge"]=e(["var min=Math.min;"],[],function(r,t){return["min((",r,"<<8)/((0xFF-",t,")+1),255.0)"]}),m["color-burn"]=e(["var max=Math.max;"],[],function(r,t){return["max(255.0-(((0xFF-",r,")<<8)/(",t,"+1)),.0)"]}),m["hard-light"]=e([],[],function(r,t){return[t,">128","?0xFF-(((0xFF-2*(",t,"-128))*(0xFF-",r,"))>>>8)",":(",r,"*",t,")>>>7"]}),m["soft-light"]=e(["var tmp;var sqrt=Math.sqrt;"],[],function(r,t){return["tmp=",t,"<<1,","(",t,"<128","?(",r,"*(tmp+(",r,"*(0xFF-tmp)/256)))/256",":(",r,"*(511-tmp)+(sqrt(",r,"<<8)*(tmp-0xFF)))/256)"]}),m.difference=e(["var abs=Math.abs;"],[],function(r,t){return["abs(",r,"-",t,")"]}),m.exclusion=e([],[],function(r,t){return[r,"+",t,"-(2*",r,"*",t,")/255.0"]}),m.hue=e(["var L,D,N,X,opt4,opt5,rRes,gRes,bRes,minEl,rSrcF,gSrcF,bSrcF,rDestF,gDestF,bDestF,minI,midI,maxI,S;","var rgb=[.0,.0,.0];","var min=Math.min;","var max=Math.max;"],[c(),"L=",a("rDestF","gDestF","bDestF"),";","S=",s("rDestF","gDestF","bDestF"),";",n("rSrcF","gSrcF","bSrcF"),F("rSrcF","gSrcF","bSrcF"),o()],function(r,t){return[r[0],"Res"]}),m.saturation=e(["var L,D,N,X,opt4,opt5,rRes,gRes,bRes,minEl,rSrcF,gSrcF,bSrcF,rDestF,gDestF,bDestF,minI,midI,maxI,S;","var rgb=[.0,.0,.0];","var min=Math.min;","var max=Math.max;"],[c(),"L=",a("rDestF","gDestF","bDestF"),";","S=",s("rSrcF","gSrcF","bSrcF"),";",n("rDestF","gDestF","bDestF"),F("rDestF","gDestF","bDestF"),o()],function(r,t){return[r[0],"Res"]}),m.color=e(["var L,D,N,X,opt4,opt5,rRes,gRes,bRes,rSrcF,gSrcF,bSrcF,rDestF,gDestF,bDestF;","var min=Math.min;","var max=Math.max;"],[c(),"L=",a("rDestF","gDestF","bDestF"),";",F("rSrcF","gSrcF","bSrcF"),o()],function(r,t){return[r[0],"Res"]}),m.luminosity=e(["var L,D,N,X,opt4,opt5,rRes,gRes,bRes,rSrcF,gSrcF,bSrcF,rDestF,gDestF,bDestF;","var min=Math.min;","var max=Math.max;"],[c(),"L=",a("rSrcF","gSrcF","bSrcF"),";",F("rDestF","gDestF","bDestF"),o()],function(r,t){return[r[0],"Res"]}),i=D=S=p=I=g=b=R=u=x=f=v=l=e=t=a=F=s=n=c=o=null,m}"undefined"!=typeof module&&"undefined"!=typeof module.exports&&(module.exports=globalCompositeOperation);